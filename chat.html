<html>

<head>
    <script src="./js/firebase-app.js"></script>
    <script src="./js/firebase-messaging.js"></script>

    <script>
        var firebaseConfig = {
            apiKey: "AIzaSyDC5FsrmBfOEOID_E_8RCao1qVwxeVNjTk",
            authDomain: "test-4133202.firebaseapp.com",
            databaseURL: "https://test-4133202.firebaseio.com",
            projectId: "test-4133202",
            storageBucket: "test-4133202.appspot.com",
            messagingSenderId: "681769623544",
            appId: "1:681769623544:web:3c6d1754bf7d3e39"
        };

        firebase.initializeApp(firebaseConfig);
        const messaging = firebase.messaging();
        messaging.usePublicVapidKey("BMtDA58iV-13pirlzlloMuDOY-OwkIoxVlBgM4WCx-mlsN4GbveRly9bBkZ6Q0mYgpfwRCjvtOWrB6dF6NKgcts");


    </script>
</head>

<body>
    <div id='message'>
        <h1>Hello Web FCM</h1>
        <p>Click on Subscribe button to hello world!</p>
        <ul>
            <li><a href='javascript:subscribeFCM()'>Subscribe</a></li>
            <li><a href='javascript:showToken()'>Show Token</a></li>
        </ul>
        <h3>Token</h3>
        <p id='token'></p>
    </div>
</body>

</html>
<script>
    function subscribeFCM() {
        messaging.requestPermission()
            .then(function () {
                console.log('Notification permission granted.');
            })
            .catch(function (err) {
                console.log('Unable to get permission to notify.', err);
            });
    }
    function showToken() {
        // Get Instance ID token. Initially this makes a network call, once retrieved
        // subsequent calls to getToken will return from cache.
        messaging.getToken()
            .then(function (currentToken) {
                if (currentToken) {
                    console.log('currentToken', currentToken);
                    $('#token').html(currentToken);
                } else {
                    // Show permission request.
                    console.log('No Instance ID token available.Request permission to generate one.');
                    $('#token').html('foo');
                }
            })
            .catch(function (err) {
                console.log('An error occurred while retrieving token.', err);
    });
   }
    messaging.onTokenRefresh(function () {
        messaging.getToken()
            .then(function (refreshedToken) {
                console.log('Token refreshed.');
                $('#token').html(refreshedToken);
            })
            .catch(function (err) {
                console.log('Unable to retrieve refreshed token ', err);
            });
    });
</script>